<html>

<head>
	<style>
		body {
			font-family: sans-serif;
		}

		#addressList {
			width: 300px;
		}

		input {
			font-size: 30px;
		}

		.help {
			color: gray;
		}

		.hidden {
			display: none;
		}

		ul {
			list-style-type: none;
			padding: 0;
		}

		a {
			color: red;
			float: right;
			cursor: pointer;
		}
	</style>
</head>

<body>
	<form id="addressList" onsubmit="formSubmit(this); return false">
		<input>
		<p class="help">Type an email address and hit enter</p>
		<ul>
		</ul>
	</form>
	<script>
			'use strict';

			// Detect the change and sync model
			let observer = new MutationObserver(function(mutations) {
				for(let i in mutations) {
					let mutation = mutations[i];
					if (mutation.type == 'childList') { // will support only removing of items for demo
						console.log('change detected', mutation);
						let li = mutation.removedNodes[0];
						if (!li) {return;} // not a deletion
						list.splice(li._index);
						console.log('deleted #', li._index, 'from', list);
					}
				}
			});

			// Start observing the target node for configured mutations
			observer.observe(document.querySelector('#addressList ul'), {
				childList:true
			});
			
			// Model
			const address = {
				id: null,
				value: ''
			}
			let list = [];

			// Handle form 
			function formSubmit(form) {
				let input = form.querySelector('input');
				let item = Object.create(address);
				item.id = String(Date.now());
				item.value = input.value;
				list.push(item);
				console.log('form submit', form, item);
				let ul = form.querySelector('ul');
				render(form);
			}

			// Delete item from the DOM
			function deleteItem(a) {
				console.log('delete item', a);
				a.parentNode.parentNode.removeChild(a.parentNode);
			}

			// Render list item
			function renderItem(item, index) {
				console.log('render item', item);
				let li = document.createElement('li');
				li.innerHTML = '<a onclick="deleteItem(this)" href="javascript:;">delete</a><span>' + item.value + '</span>';
				li.setAttribute('id', item.id);
				li._index = index;
				return li;
			}

			// Render list when data is changed
			function render(form) {
				console.log('render', form, list);
				let ul = form.querySelector('ul');
				ul.innerHTML = '';
				list.forEach(function(item, index) {
					ul.appendChild(renderItem(item, index));
				});
			}

	</script>
</body>

</html>